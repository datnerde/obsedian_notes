---
annotation-target: speculative sampling.pdf
---


>%%
>```annotation-json
>{"created":"2023-09-12T15:47:32.120Z","updated":"2023-09-12T15:47:32.120Z","document":{"title":"speculative sampling.pdf","link":[{"href":"urn:x-pdf:4d0ac52d083f2915952051a645b9930b"},{"href":"vault:/Research/paper reading/speculative sampling.pdf"}],"documentFingerprint":"4d0ac52d083f2915952051a645b9930b"},"uri":"vault:/Research/paper reading/speculative sampling.pdf","target":[{"source":"vault:/Research/paper reading/speculative sampling.pdf","selector":[{"type":"TextPositionSelector","start":293,"end":364},{"type":"TextQuoteSelector","exact":"by enabling thegeneration of multiple tokens from each transformer call","prefix":"celerating transformer decoding ","suffix":". Our algorithm relies on the ob"}]}]}
>```
>%%
>*%%PREFIX%%celerating transformer decoding%%HIGHLIGHT%% ==by enabling thegeneration of multiple tokens from each transformer call== %%POSTFIX%%. Our algorithm relies on the ob*
>%%LINK%%[[#^8rszymi1dqu|show annotation]]
>%%COMMENT%%
>
>%%TAGS%%
>
^8rszymi1dqu


>%%
>```annotation-json
>{"created":"2023-09-12T15:48:24.820Z","updated":"2023-09-12T15:48:24.820Z","document":{"title":"speculative sampling.pdf","link":[{"href":"urn:x-pdf:4d0ac52d083f2915952051a645b9930b"},{"href":"vault:/Research/paper reading/speculative sampling.pdf"}],"documentFingerprint":"4d0ac52d083f2915952051a645b9930b"},"uri":"vault:/Research/paper reading/speculative sampling.pdf","target":[{"source":"vault:/Research/paper reading/speculative sampling.pdf","selector":[{"type":"TextPositionSelector","start":5903,"end":6064},{"type":"TextQuoteSelector","exact":"We focus more heavily the distributedserving setting for large models and offer some incremental optimisations, but otherwise the coreunderlying idea is the same","prefix":"g from Leviathan et al. (2022). ","suffix":".Auto-regressive SamplingWhilst "}]}]}
>```
>%%
>*%%PREFIX%%g from Leviathan et al. (2022).%%HIGHLIGHT%% ==We focus more heavily the distributedserving setting for large models and offer some incremental optimisations, but otherwise the coreunderlying idea is the same== %%POSTFIX%%.Auto-regressive SamplingWhilst*
>%%LINK%%[[#^6zs9kjuxc2f|show annotation]]
>%%COMMENT%%
>
>%%TAGS%%
>
^6zs9kjuxc2f


>%%
>```annotation-json
>{"created":"2023-09-12T16:24:04.760Z","updated":"2023-09-12T16:24:04.760Z","document":{"title":"speculative sampling.pdf","link":[{"href":"urn:x-pdf:4d0ac52d083f2915952051a645b9930b"},{"href":"vault:/Research/paper reading/speculative sampling.pdf"}],"documentFingerprint":"4d0ac52d083f2915952051a645b9930b"},"uri":"vault:/Research/paper reading/speculative sampling.pdf","target":[{"source":"vault:/Research/paper reading/speculative sampling.pdf","selector":[{"type":"TextPositionSelector","start":466,"end":596},{"type":"TextQuoteSelector","exact":"generated by a faster but less powerful draftmodel, is comparable to that of sampling a single token from the larger target model.","prefix":"scoring of short continuations, ","suffix":" This is combinedwith a novel mo"}]}]}
>```
>%%
>*%%PREFIX%%scoring of short continuations,%%HIGHLIGHT%% ==generated by a faster but less powerful draftmodel, is comparable to that of sampling a single token from the larger target model.== %%POSTFIX%%This is combinedwith a novel mo*
>%%LINK%%[[#^gvh6uzuhqgd|show annotation]]
>%%COMMENT%%
>
>%%TAGS%%
>
^gvh6uzuhqgd


>%%
>```annotation-json
>{"created":"2023-09-12T16:24:13.899Z","updated":"2023-09-12T16:24:13.899Z","document":{"title":"speculative sampling.pdf","link":[{"href":"urn:x-pdf:4d0ac52d083f2915952051a645b9930b"},{"href":"vault:/Research/paper reading/speculative sampling.pdf"}],"documentFingerprint":"4d0ac52d083f2915952051a645b9930b"},"uri":"vault:/Research/paper reading/speculative sampling.pdf","target":[{"source":"vault:/Research/paper reading/speculative sampling.pdf","selector":[{"type":"TextPositionSelector","start":620,"end":737},{"type":"TextQuoteSelector","exact":"novel modified rejection sampling scheme which preserves the distribution of the target modelwithin hardware numerics","prefix":"t model. This is combinedwith a ","suffix":". We benchmark speculative sampl"}]}]}
>```
>%%
>*%%PREFIX%%t model. This is combinedwith a%%HIGHLIGHT%% ==novel modified rejection sampling scheme which preserves the distribution of the target modelwithin hardware numerics== %%POSTFIX%%. We benchmark speculative sampl*
>%%LINK%%[[#^m6xbl0k81qj|show annotation]]
>%%COMMENT%%
>
>%%TAGS%%
>
^m6xbl0k81qj


>%%
>```annotation-json
>{"created":"2023-09-12T16:58:54.291Z","updated":"2023-09-12T16:58:54.291Z","document":{"title":"speculative sampling.pdf","link":[{"href":"urn:x-pdf:4d0ac52d083f2915952051a645b9930b"},{"href":"vault:/Research/paper reading/speculative sampling.pdf"}],"documentFingerprint":"4d0ac52d083f2915952051a645b9930b"},"uri":"vault:/Research/paper reading/speculative sampling.pdf","target":[{"source":"vault:/Research/paper reading/speculative sampling.pdf","selector":[{"type":"TextPositionSelector","start":2077,"end":2116},{"type":"TextQuoteSelector","exact":"Generating a short draft of length 𝐾. ","prefix":"g (SpS). This is achieved by:1. ","suffix":"This can be attained with either"}]}]}
>```
>%%
>*%%PREFIX%%g (SpS). This is achieved by:1.%%HIGHLIGHT%% ==Generating a short draft of length 𝐾.== %%POSTFIX%%This can be attained with either*
>%%LINK%%[[#^3odiona61c8|show annotation]]
>%%COMMENT%%
>
>%%TAGS%%
>
^3odiona61c8
