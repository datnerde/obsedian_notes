---
annotation-target: speculative sampling.pdf
---


>%%
>```annotation-json
>{"created":"2023-09-12T15:47:32.120Z","updated":"2023-09-12T15:47:32.120Z","document":{"title":"speculative sampling.pdf","link":[{"href":"urn:x-pdf:4d0ac52d083f2915952051a645b9930b"},{"href":"vault:/Research/paper reading/speculative sampling.pdf"}],"documentFingerprint":"4d0ac52d083f2915952051a645b9930b"},"uri":"vault:/Research/paper reading/speculative sampling.pdf","target":[{"source":"vault:/Research/paper reading/speculative sampling.pdf","selector":[{"type":"TextPositionSelector","start":293,"end":364},{"type":"TextQuoteSelector","exact":"by enabling thegeneration of multiple tokens from each transformer call","prefix":"celerating transformer decoding ","suffix":". Our algorithm relies on the ob"}]}]}
>```
>%%
>*%%PREFIX%%celerating transformer decoding%%HIGHLIGHT%% ==by enabling thegeneration of multiple tokens from each transformer call== %%POSTFIX%%. Our algorithm relies on the ob*
>%%LINK%%[[#^8rszymi1dqu|show annotation]]
>%%COMMENT%%
>
>%%TAGS%%
>
^8rszymi1dqu


>%%
>```annotation-json
>{"created":"2023-09-12T15:48:24.820Z","updated":"2023-09-12T15:48:24.820Z","document":{"title":"speculative sampling.pdf","link":[{"href":"urn:x-pdf:4d0ac52d083f2915952051a645b9930b"},{"href":"vault:/Research/paper reading/speculative sampling.pdf"}],"documentFingerprint":"4d0ac52d083f2915952051a645b9930b"},"uri":"vault:/Research/paper reading/speculative sampling.pdf","target":[{"source":"vault:/Research/paper reading/speculative sampling.pdf","selector":[{"type":"TextPositionSelector","start":5903,"end":6064},{"type":"TextQuoteSelector","exact":"We focus more heavily the distributedserving setting for large models and offer some incremental optimisations, but otherwise the coreunderlying idea is the same","prefix":"g from Leviathan et al. (2022). ","suffix":".Auto-regressive SamplingWhilst "}]}]}
>```
>%%
>*%%PREFIX%%g from Leviathan et al. (2022).%%HIGHLIGHT%% ==We focus more heavily the distributedserving setting for large models and offer some incremental optimisations, but otherwise the coreunderlying idea is the same== %%POSTFIX%%.Auto-regressive SamplingWhilst*
>%%LINK%%[[#^6zs9kjuxc2f|show annotation]]
>%%COMMENT%%
>
>%%TAGS%%
>
^6zs9kjuxc2f


>%%
>```annotation-json
>{"created":"2023-09-12T16:24:04.760Z","updated":"2023-09-12T16:24:04.760Z","document":{"title":"speculative sampling.pdf","link":[{"href":"urn:x-pdf:4d0ac52d083f2915952051a645b9930b"},{"href":"vault:/Research/paper reading/speculative sampling.pdf"}],"documentFingerprint":"4d0ac52d083f2915952051a645b9930b"},"uri":"vault:/Research/paper reading/speculative sampling.pdf","target":[{"source":"vault:/Research/paper reading/speculative sampling.pdf","selector":[{"type":"TextPositionSelector","start":466,"end":596},{"type":"TextQuoteSelector","exact":"generated by a faster but less powerful draftmodel, is comparable to that of sampling a single token from the larger target model.","prefix":"scoring of short continuations, ","suffix":" This is combinedwith a novel mo"}]}]}
>```
>%%
>*%%PREFIX%%scoring of short continuations,%%HIGHLIGHT%% ==generated by a faster but less powerful draftmodel, is comparable to that of sampling a single token from the larger target model.== %%POSTFIX%%This is combinedwith a novel mo*
>%%LINK%%[[#^gvh6uzuhqgd|show annotation]]
>%%COMMENT%%
>
>%%TAGS%%
>
^gvh6uzuhqgd


>%%
>```annotation-json
>{"created":"2023-09-12T16:24:13.899Z","updated":"2023-09-12T16:24:13.899Z","document":{"title":"speculative sampling.pdf","link":[{"href":"urn:x-pdf:4d0ac52d083f2915952051a645b9930b"},{"href":"vault:/Research/paper reading/speculative sampling.pdf"}],"documentFingerprint":"4d0ac52d083f2915952051a645b9930b"},"uri":"vault:/Research/paper reading/speculative sampling.pdf","target":[{"source":"vault:/Research/paper reading/speculative sampling.pdf","selector":[{"type":"TextPositionSelector","start":620,"end":737},{"type":"TextQuoteSelector","exact":"novel modified rejection sampling scheme which preserves the distribution of the target modelwithin hardware numerics","prefix":"t model. This is combinedwith a ","suffix":". We benchmark speculative sampl"}]}]}
>```
>%%
>*%%PREFIX%%t model. This is combinedwith a%%HIGHLIGHT%% ==novel modified rejection sampling scheme which preserves the distribution of the target modelwithin hardware numerics== %%POSTFIX%%. We benchmark speculative sampl*
>%%LINK%%[[#^m6xbl0k81qj|show annotation]]
>%%COMMENT%%
>
>%%TAGS%%
>
^m6xbl0k81qj


>%%
>```annotation-json
>{"created":"2023-09-12T16:58:54.291Z","updated":"2023-09-12T16:58:54.291Z","document":{"title":"speculative sampling.pdf","link":[{"href":"urn:x-pdf:4d0ac52d083f2915952051a645b9930b"},{"href":"vault:/Research/paper reading/speculative sampling.pdf"}],"documentFingerprint":"4d0ac52d083f2915952051a645b9930b"},"uri":"vault:/Research/paper reading/speculative sampling.pdf","target":[{"source":"vault:/Research/paper reading/speculative sampling.pdf","selector":[{"type":"TextPositionSelector","start":2077,"end":2116},{"type":"TextQuoteSelector","exact":"Generating a short draft of length 𝐾. ","prefix":"g (SpS). This is achieved by:1. ","suffix":"This can be attained with either"}]}]}
>```
>%%
>*%%PREFIX%%g (SpS). This is achieved by:1.%%HIGHLIGHT%% ==Generating a short draft of length 𝐾.== %%POSTFIX%%This can be attained with either*
>%%LINK%%[[#^3odiona61c8|show annotation]]
>%%COMMENT%%
>
>%%TAGS%%
>
^3odiona61c8


>%%
>```annotation-json
>{"created":"2023-09-12T16:59:32.677Z","updated":"2023-09-12T16:59:32.677Z","document":{"title":"speculative sampling.pdf","link":[{"href":"urn:x-pdf:4d0ac52d083f2915952051a645b9930b"},{"href":"vault:/Research/paper reading/speculative sampling.pdf"}],"documentFingerprint":"4d0ac52d083f2915952051a645b9930b"},"uri":"vault:/Research/paper reading/speculative sampling.pdf","target":[{"source":"vault:/Research/paper reading/speculative sampling.pdf","selector":[{"type":"TextPositionSelector","start":2211,"end":2226},{"type":"TextQuoteSelector","exact":"uto-regressive ","prefix":" 2018) or by calling a faster, a","suffix":"model 𝐾 times. We shall refer t"}]}]}
>```
>%%
>*%%PREFIX%%2018) or by calling a faster, a%%HIGHLIGHT%% ==uto-regressive== %%POSTFIX%%model 𝐾 times. We shall refer t*
>%%LINK%%[[#^o73my3xwxik|show annotation]]
>%%COMMENT%%
>
>%%TAGS%%
>
^o73my3xwxik


>%%
>```annotation-json
>{"created":"2023-09-12T17:01:43.563Z","updated":"2023-09-12T17:01:43.563Z","document":{"title":"speculative sampling.pdf","link":[{"href":"urn:x-pdf:4d0ac52d083f2915952051a645b9930b"},{"href":"vault:/Research/paper reading/speculative sampling.pdf"}],"documentFingerprint":"4d0ac52d083f2915952051a645b9930b"},"uri":"vault:/Research/paper reading/speculative sampling.pdf","target":[{"source":"vault:/Research/paper reading/speculative sampling.pdf","selector":[{"type":"TextPositionSelector","start":2343,"end":2411},{"type":"TextQuoteSelector","exact":"Scoring the draft using the larger, more powerful model from we wish","prefix":" where it is auto-regressive.2. ","suffix":" to sample from. We shallrefer t"}]}]}
>```
>%%
>*%%PREFIX%%where it is auto-regressive.2.%%HIGHLIGHT%% ==Scoring the draft using the larger, more powerful model from we wish== %%POSTFIX%%to sample from. We shallrefer t*
>%%LINK%%[[#^3dvlos4enyo|show annotation]]
>%%COMMENT%%
>
>%%TAGS%%
>
^3dvlos4enyo


>%%
>```annotation-json
>{"created":"2023-09-12T17:01:47.063Z","updated":"2023-09-12T17:01:47.063Z","document":{"title":"speculative sampling.pdf","link":[{"href":"urn:x-pdf:4d0ac52d083f2915952051a645b9930b"},{"href":"vault:/Research/paper reading/speculative sampling.pdf"}],"documentFingerprint":"4d0ac52d083f2915952051a645b9930b"},"uri":"vault:/Research/paper reading/speculative sampling.pdf","target":[{"source":"vault:/Research/paper reading/speculative sampling.pdf","selector":[{"type":"TextPositionSelector","start":2487,"end":2521},{"type":"TextQuoteSelector","exact":"modified rejection sampling scheme","prefix":" as the target model.3. Using a ","suffix":", accept a subset of the 𝐾 draf"}]}]}
>```
>%%
>*%%PREFIX%%as the target model.3. Using a%%HIGHLIGHT%% ==modified rejection sampling scheme== %%POSTFIX%%, accept a subset of the 𝐾 draf*
>%%LINK%%[[#^1te14jz4ogk|show annotation]]
>%%COMMENT%%
>
>%%TAGS%%
>
^1te14jz4ogk


>%%
>```annotation-json
>{"created":"2023-09-12T17:06:42.476Z","updated":"2023-09-12T17:06:42.476Z","document":{"title":"speculative sampling.pdf","link":[{"href":"urn:x-pdf:4d0ac52d083f2915952051a645b9930b"},{"href":"vault:/Research/paper reading/speculative sampling.pdf"}],"documentFingerprint":"4d0ac52d083f2915952051a645b9930b"},"uri":"vault:/Research/paper reading/speculative sampling.pdf","target":[{"source":"vault:/Research/paper reading/speculative sampling.pdf","selector":[{"type":"TextPositionSelector","start":6094,"end":6214},{"type":"TextQuoteSelector","exact":"t transformers can be trained efficiently and in parallel on TPUs and GPUs, samples are typicallydrawn auto-regressively","prefix":"me.Auto-regressive SamplingWhils","suffix":" (See algorithm 1). For most app"}]}]}
>```
>%%
>*%%PREFIX%%me.Auto-regressive SamplingWhils%%HIGHLIGHT%% ==t transformers can be trained efficiently and in parallel on TPUs and GPUs, samples are typicallydrawn auto-regressively== %%POSTFIX%%(See algorithm 1). For most app*
>%%LINK%%[[#^c0phr3trppf|show annotation]]
>%%COMMENT%%
>
>%%TAGS%%
>
^c0phr3trppf


>%%
>```annotation-json
>{"created":"2023-09-12T17:08:21.617Z","updated":"2023-09-12T17:08:21.617Z","document":{"title":"speculative sampling.pdf","link":[{"href":"urn:x-pdf:4d0ac52d083f2915952051a645b9930b"},{"href":"vault:/Research/paper reading/speculative sampling.pdf"}],"documentFingerprint":"4d0ac52d083f2915952051a645b9930b"},"uri":"vault:/Research/paper reading/speculative sampling.pdf","target":[{"source":"vault:/Research/paper reading/speculative sampling.pdf","selector":[{"type":"TextPositionSelector","start":6897,"end":6967},{"type":"TextQuoteSelector","exact":" gives us a hard ceiling on the maximum auto-regressive samplingspeed.","prefix":"emory bandwidth across all chips","suffix":" Larger models also require serv"}]}]}
>```
>%%
>*%%PREFIX%%emory bandwidth across all chips%%HIGHLIGHT%% ==gives us a hard ceiling on the maximum auto-regressive samplingspeed.== %%POSTFIX%%Larger models also require serv*
>%%LINK%%[[#^3egqntsbdzj|show annotation]]
>%%COMMENT%%
>
>%%TAGS%%
>
^3egqntsbdzj


>%%
>```annotation-json
>{"created":"2023-09-12T17:16:21.548Z","updated":"2023-09-12T17:16:21.548Z","document":{"title":"speculative sampling.pdf","link":[{"href":"urn:x-pdf:4d0ac52d083f2915952051a645b9930b"},{"href":"vault:/Research/paper reading/speculative sampling.pdf"}],"documentFingerprint":"4d0ac52d083f2915952051a645b9930b"},"uri":"vault:/Research/paper reading/speculative sampling.pdf","target":[{"source":"vault:/Research/paper reading/speculative sampling.pdf","selector":[{"type":"TextPositionSelector","start":10683,"end":10825},{"type":"TextQuoteSelector","exact":" require a method to recover the distribution of the target model from samples from the draftmodel, and logits of said tokens from both models","prefix":"𝐾.Modified Rejection SamplingWe","suffix":".To achieve this, we introduce t"}]}]}
>```
>%%
>*%%PREFIX%%𝐾.Modified Rejection SamplingWe%%HIGHLIGHT%% ==require a method to recover the distribution of the target model from samples from the draftmodel, and logits of said tokens from both models== %%POSTFIX%%.To achieve this, we introduce t*
>%%LINK%%[[#^8xpa4pr8jlt|show annotation]]
>%%COMMENT%%
>
>%%TAGS%%
>
^8xpa4pr8jlt


>%%
>```annotation-json
>{"created":"2023-09-12T17:37:42.395Z","text":"no freaking idea what this is talking about","updated":"2023-09-12T17:37:42.395Z","document":{"title":"speculative sampling.pdf","link":[{"href":"urn:x-pdf:4d0ac52d083f2915952051a645b9930b"},{"href":"vault:/Research/paper reading/speculative sampling.pdf"}],"documentFingerprint":"4d0ac52d083f2915952051a645b9930b"},"uri":"vault:/Research/paper reading/speculative sampling.pdf","target":[{"source":"vault:/Research/paper reading/speculative sampling.pdf","selector":[{"type":"TextPositionSelector","start":10654,"end":10680},{"type":"TextQuoteSelector","exact":"Modified Rejection Samplin","prefix":"gnificantly slower for small 𝐾.","suffix":"gWe require a method to recover "}]}]}
>```
>%%
>*%%PREFIX%%gnificantly slower for small 𝐾.%%HIGHLIGHT%% ==Modified Rejection Samplin== %%POSTFIX%%gWe require a method to recover*
>%%LINK%%[[#^g9p77766k8|show annotation]]
>%%COMMENT%%
>no freaking idea what this is talking about
>%%TAGS%%
>
^g9p77766k8


>%%
>```annotation-json
>{"created":"2023-09-12T17:38:18.441Z","text":"what does logits mean in this context?\n","updated":"2023-09-12T17:38:18.441Z","document":{"title":"speculative sampling.pdf","link":[{"href":"urn:x-pdf:4d0ac52d083f2915952051a645b9930b"},{"href":"vault:/Research/paper reading/speculative sampling.pdf"}],"documentFingerprint":"4d0ac52d083f2915952051a645b9930b"},"uri":"vault:/Research/paper reading/speculative sampling.pdf","target":[{"source":"vault:/Research/paper reading/speculative sampling.pdf","selector":[{"type":"TextPositionSelector","start":12979,"end":13007},{"type":"TextQuoteSelector","exact":"as long as it exposes logits","prefix":"hod for drafting a continuation ","suffix":", and there is a highenough acce"}]}]}
>```
>%%
>*%%PREFIX%%hod for drafting a continuation%%HIGHLIGHT%% ==as long as it exposes logits== %%POSTFIX%%, and there is a highenough acce*
>%%LINK%%[[#^ap9ryhyt39|show annotation]]
>%%COMMENT%%
>what does logits mean in this context?
>
>%%TAGS%%
>
^ap9ryhyt39
